income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
geom_text_repel(aes(color = education, label = education, size = sirius)) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
geom_text_repel(aes(color = education, label = education, size = wharton)) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
grid.arrange(sirius, wharton, ncol = 2)
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
geom_text_repel(aes(color = education, size = sirius)) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
geom_text_repel(aes(color = education, size = wharton)) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
grid.arrange(sirius, wharton, ncol = 2)
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
grid.arrange(sirius, wharton, ncol = 2)
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
egend(x=-3,y=7,c("sample1","sample2"),cex=.8,col=c("red","blue"),pch=c(1,2))
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
legend(x=-3,y=7,c("sample1","sample2"),cex=.8,col=c("red","blue"),pch=c(1,2))
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = "none")
legend(x = "topleft", box.col = "brown",
bg ="yellow", box.lwd = 2 , title="EQUATIONS",
legend=c(education),
fill = c(education))
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.9, 0.2))
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.9, 0.2))
grid.arrange(sirius, wharton, ncol = 2)
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 8, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.5, 0.5))
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.5, 0.5))
grid.arrange(sirius, wharton, ncol = 2)
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 7, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.5, 0.5))
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.5, 0.5))
grid.arrange(sirius, wharton, ncol = 2)
table(results$age)
# convert character to integer for datatype of age and worktime for calculation
results$age = as.integer(as.character(results$age))
results$worktime <- as.integer(as.character(results$worktime))
skimr::skim(results)
summary(results)
# distribution of age, education, and income in our sample -- histograms
age <- ggplot(results) +
geom_histogram(aes(x = age), bins = 7, fill = "darkblue") +
labs( title = "Histogram of Age", x = "Age" , y = "Frequency")
education <- ggplot(results) +
geom_histogram(aes(x = education), stat="count", fill = "blue") +
labs( title = "Histogram of Education", x = "Education" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
college_prop = (611+745+177)/1725
income <- ggplot(results) +
geom_histogram(aes(x = income), stat="count", fill = "lightblue") +
labs( title = "Histogram of Income", x = "Income" , y = "Frequency") +
theme(axis.text.x = element_text(angle = -60))
grid.arrange(age, education, income, ncol = 3)
# scatterplot on sirius and wharton
sirius <- results %>%
ggplot(aes(x = sirius, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Sirius or no",
x = "Listens to Sirius?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.5, 0.5))
wharton <- results %>%
ggplot(aes(x = wharton, y = age)) +
# geometric options with aes mapping:
# color, size, alpha as a function of a variable
geom_point(aes(color = education), size = 3) +
labs(title = "Age vs. Listens to Wharton or no",
x = "Listens to Wharton?",
y = "Age") +
theme_bw() +
theme(legend.position = c(0.5, 0.5))
grid.arrange(sirius, wharton, ncol = 2)
View(results)
knitr::opts_chunk$set(echo = TRUE, fig.width=8, fig.height=4)
options(scipen = 0, digits = 3)  # controls base R output
if(!require('pacman')) {
install.packages('pacman')
}
pacman::p_load(ggplot2, dplyr, tidyverse, gridExtra, ggrepel, plotly, skimr, tidytext)
# install a package if it does not exist already and put the package in the path (library)
# dplyr, ggplot2,tidyr
# install.packages('ggplot2')
#library(ggplot2)
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes")
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
count(filter(wharton == "Yes"))
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes").count()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes")
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
sum(filter(wharton == "Yes"))
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
nrow(filter(wharton == "Yes"))
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
wharton_prop = filter(wharton == "Yes") %>% nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
wharton_prop <- filter(wharton == "Yes") %>% nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes") %>%
nrow()
results %>%
filter(wharton == "Sirius") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes") %>%
nrow()
results %>%
filter(sirius == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes") %>%
nrow() %>%
filter(sirius == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
results %>%
filter(wharton == "Yes") %>%
nrow()
results %>%
filter(sirius == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
wharton_prop <-
results %>%
filter(wharton == "Yes") %>%
nrow()
results %>%
filter(sirius == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
wharton_prop <-
results %>%
filter(wharton == "Yes") %>%
nrow()
sirius_prop <-
results %>%
filter(sirius == "Yes") %>%
nrow()
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
wharton_prop <-
results %>%
filter(wharton == "Yes") %>%
nrow()
sirius_prop <-
results %>%
filter(sirius == "Yes") %>%
nrow()
p <- wharton_prop/sirius_prop
#One approach is to estimate the proportion of the Wharton listeners to that of the Sirius listeners, $p$, so that we will come up with an audience size estimate of approximately 51.6 million times $p$.
wharton_prop <-
results %>%
filter(wharton == "Yes") %>%
nrow()
sirius_prop <-
results %>%
filter(sirius == "Yes") %>%
nrow()
p <- wharton_prop/sirius_prop
audience_size = 51600000 * p
